<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>








// 工具函数：显示弹窗
    function showDialog(dialogId) {
      document.getElementById(dialogId).style.display = 'flex';
    }

    // 工具函数：隐藏弹窗
    function hideDialog(dialogId) {
      document.getElementById(dialogId).style.display = 'none';
    }

    // 随机捞取逻辑
    document.getElementById('openRandom').addEventListener('click', () => {
      showDialog('randomDialog');
      appState.random.loading = true;
      updateRandomDialog();
      setTimeout(() => {
        appState.random.loading = false;
        appState.random.reply = '';
        updateRandomDialog();
      }, 800);
    });

    // 再捞一个
    document.getElementById('randomPrev').addEventListener('click', () => {
      appState.random.loading = true;
      updateRandomDialog();
      setTimeout(() => {
        appState.random.data = {
          id: Math.floor(Math.random() * 1000),
          author: '匿名小可爱',
          time: new Date().toLocaleString(),
          content: ['今晚的月色很美，想和你一起看…', '今天遇到了一只很可爱的流浪猫～', '最近工作压力有点大，希望明天会更好'][Math.floor(Math.random()*3)]
        };
        appState.random.loading = false;
        updateRandomDialog();
      }, 800);
    });

    // 提交随机回复
    document.getElementById('submitRandomReply').addEventListener('click', () => {
      if (appState.random.reply.trim()) {
        alert('回复成功！');
        hideDialog('randomDialog');
      } else {
        alert('回复内容不能为空');
      }
    });

    // 精准打捞逻辑
    document.getElementById('openPrecise').addEventListener('click', () => {
      showDialog('preciseDialog');
      appState.precise.stage = 0;
      appState.precise.id = '';
      document.getElementById('preciseIdInput').value = '';
      updatePreciseDialog();
    });

    // 执行精准搜索
    document.getElementById('preciseSearch').addEventListener('click', () => {
      const id = document.getElementById('preciseIdInput').value.trim();
      if (!id) {
        alert('请输入瓶子编号');
        return;
      }
      appState.precise.stage = 1;
      appState.precise.data = {
        id: id,
        author: '匿名漂流者',
        time: new Date().toLocaleString(),
        content: '我从商店买了个高精度捞网…'
      };
      updatePreciseDialog();
    });

    // 精准回复提交
    document.getElementById('submitPreciseReply').addEventListener('click', () => {
      const reply = document.getElementById('preciseReply').value.trim();
      if (reply) {
        alert('精准回复成功！');
        hideDialog('preciseDialog');
      } else {
        alert('回复内容不能为空');
      }
    });

    // 返回精准搜索输入
    document.getElementById('preciseBack').addEventListener('click', () => {
      appState.precise.stage = 0;
      updatePreciseDialog();
    });

    // 取消精准打捞
    document.getElementById('preciseCancel').addEventListener('click', () => {
      hideDialog('preciseDialog');
    });

    // 丢瓶子逻辑
    document.getElementById('openThrow').addEventListener('click', () => {
      showDialog('throwDialog');
      document.getElementById('throwUser').value = '';
      document.getElementById('throwContent').value = '';
    });

    // 提交丢瓶子
    document.getElementById('submitThrow').addEventListener('click', () => {
      const content = document.getElementById('throwContent').value.trim();
      if (!content) {
        alert('内容不能为空');
        return;
      }
      appState.count++; // 模拟瓶子数量增加
      document.getElementById('count').textContent = appState.count;
      alert('扔瓶成功！');
      hideDialog('throwDialog');
    });

    // 取消丢瓶子
    document.getElementById('throwCancel').addEventListener('click', () => {
      hideDialog('throwDialog');
    });

    // 更新随机弹窗内容
    function updateRandomDialog() {
      const loadingEl = document.querySelector('#randomContent .loading');
      const contentEl = document.querySelector('#randomContent .content');
      const randomReplyEl = document.getElementById('randomReply');

      if (appState.random.loading) {
        loadingEl.style.display = 'block';
        contentEl.style.display = 'none';
      } else {
        loadingEl.style.display = 'none';
        contentEl.style.display = 'block';
        document.getElementById('randomId').textContent = appState.random.data.id;
        document.getElementById('randomAuthor').textContent = appState.random.data.author;
        document.getElementById('randomTime').textContent = appState.random.data.time;
        document.getElementById('randomContentText').textContent = appState.random.data.content;
        randomReplyEl.value = appState.random.reply;
      }
    }

    // 更新精准弹窗内容
    function updatePreciseDialog() {
      const stage1El = document.querySelector('#preciseContent .stage1');
      const stage2El = document.querySelector('#preciseContent .stage2');
      const preciseBackEl = document.getElementById('preciseBack');
      const submitPreciseReplyEl = document.getElementById('submitPreciseReply');
      const preciseSearchEl = document.getElementById('preciseSearch');
      const preciseCancelEl = document.getElementById('preciseCancel');

      if (appState.precise.stage === 0) {
        stage1El.style.display = 'block';
        stage2El.style.display = 'none';
        preciseBackEl.style.display = 'none';
        submitPreciseReplyEl.style.display = 'none';
        preciseSearchEl.style.display = 'inline-block';
        preciseCancelEl.style.display = 'inline-block';
      } else {
        stage1El.style.display = 'none';
        stage2El.style.display = 'block';
        preciseBackEl.style.display = 'inline-block';
        submitPreciseReplyEl.style.display = 'inline-block';
        preciseSearchEl.style.display = 'none';
        preciseCancelEl.style.display = 'none';
        document.getElementById('preciseId').textContent = appState.precise.data.id;
        document.getElementById('preciseAuthor').textContent = appState.precise.data.author;
        document.getElementById('preciseTime').textContent = appState.precise.data.time;
        document.getElementById('preciseContentText').textContent = appState.precise.data.content;
      }
    }

    // 初始化时更新计数
    document.getElementById('count').textContent = appState.count;










    </script>
</body>
</html>